<div class="inner">
  <div class="title">Header</div>
  <ng-container
    *ngTemplateOutlet="treeLayout; context: { $implicit: currentPageHeaderItems, isOpen: true }"
  ></ng-container>

  <div class="title">Body</div>
  <ng-container
    *ngTemplateOutlet="treeLayout; context: { $implicit: currentPageBodyItems, isOpen: true }"
  ></ng-container>

  <div class="title">Footer</div>
  <ng-container
    *ngTemplateOutlet="treeLayout; context: { $implicit: currentPageFooterItems, isOpen: true }"
  ></ng-container>
</div>

<ng-template #treeLayout let-list let-isOpen="isOpen">
  <ul class="tree-list" [class.is-open]="isOpen">
    @for (item of list; track $index) {
      <li
        (click)="onSelectBlock($event, item)"
        [class.active]="pageBuilderService.activeEl() == item"
      >
        <div>
          @if (item.children && item.children.length > 0) {
            <button type="button" (click)="item.isOpen = !item.isOpen">
              @if (item.isOpen) {
                <!-- chevron-down-regular -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                  <path
                    d="M432.6 209.3l-191.1 183.1C235.1 397.8 229.1 400 224 400s-11.97-2.219-16.59-6.688L15.41 209.3C5.814 200.2 5.502 184.1 14.69 175.4c9.125-9.625 24.38-9.938 33.91-.7187L224 342.8l175.4-168c9.5-9.219 24.78-8.906 33.91 .7187C442.5 184.1 442.2 200.2 432.6 209.3z"
                  />
                </svg>
              } @else {
                <!-- chevron-right-regular -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
                  <path
                    d="M113.3 47.41l183.1 191.1c4.469 4.625 6.688 10.62 6.688 16.59s-2.219 11.97-6.688 16.59l-183.1 191.1c-9.152 9.594-24.34 9.906-33.9 .7187c-9.625-9.125-9.938-24.38-.7187-33.91l168-175.4L78.71 80.6c-9.219-9.5-8.906-24.78 .7187-33.91C88.99 37.5 104.2 37.82 113.3 47.41z"
                  />
                </svg>
              }
            </button>
          }
          <span>{{ item.tag }}</span>
        </div>
        @if (item.children && item.children.length > 0) {
          <ng-container
            *ngTemplateOutlet="
              treeLayout;
              context: { $implicit: item.children, isOpen: item.isOpen }
            "
          ></ng-container>
        }
      </li>
    }
  </ul>
</ng-template>
